<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daegon Awards</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --gold: #c9a44c;
  --gold-dark: #b89440;
  --black: #000000;
  --dark: #1a1a1a;
  --gray: #666666;
  --light-gray: #f5f5f5;
  --white: #ffffff;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: var(--white);
  color: var(--dark);
  line-height: 1.6;
}

/* Header Styles */
header {
  background-color: var(--white);
  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08);
  position: sticky;
  top: 0;
  z-index: 1000;
  border-bottom: 3px solid var(--gold);
}

.header-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 15px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 15px;
}

.logo {
  display: flex;
  align-items: center;
  gap: 15px;
}

.logo-icon {
  color: var(--gold);
  font-size: 28px;
}

.logo h1 {
  font-family: 'Times New Roman', serif;
  font-size: 28px;
  letter-spacing: 2px;
  color: var(--black);
  margin: 0;
}

nav {
  flex: 1;
  display: flex;
  justify-content: flex-end;
}

nav ul {
  display: flex;
  list-style: none;
  gap: 20px;
  margin: 0;
  padding: 0;
  flex-wrap: wrap;
}

nav a {
  text-decoration: none;
  color: var(--black);
  font-weight: 600;
  font-size: 15px;
  transition: color 0.3s;
  position: relative;
  padding: 5px 0;
  white-space: nowrap;
}

nav a:hover {
  color: var(--gold);
}

nav a.active {
  color: var(--gold);
}

nav a.active::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  width: 100%;
  height: 2px;
  background-color: var(--gold);
}

/* Search Bar */
.search-container {
  flex: 1;
  max-width: 400px;
  margin-left: 20px;
}

.search-box {
  position: relative;
}

.search-box input {
  width: 100%;
  padding: 10px 15px 10px 40px;
  border: 2px solid var(--light-gray);
  border-radius: 25px;
  font-size: 14px;
  transition: all 0.3s;
}

.search-box input:focus {
  outline: none;
  border-color: var(--gold);
  box-shadow: 0 0 0 3px rgba(201, 164, 76, 0.1);
}

.search-box i {
  position: absolute;
  left: 15px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--gray);
}

.search-results {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 1px solid var(--light-gray);
  border-radius: 8px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  z-index: 1000;
  max-height: 400px;
  overflow-y: auto;
  display: none;
}

.search-result-item {
  display: flex;
  align-items: center;
  padding: 12px 15px;
  border-bottom: 1px solid var(--light-gray);
  cursor: pointer;
  transition: background-color 0.2s;
}

.search-result-item:hover {
  background-color: var(--light-gray);
}

.search-result-item img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
  margin-right: 12px;
  border: 1px solid var(--gold);
}

.search-result-info h4 {
  font-size: 14px;
  margin-bottom: 3px;
  color: var(--black);
}

.search-result-info p {
  font-size: 12px;
  color: var(--gray);
}

/* Main Container */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 30px 20px;
  min-height: calc(100vh - 180px);
}

.hidden {
  display: none !important;
}

/* Home Page */
.home-header {
  text-align: center;
  margin-bottom: 40px;
}

.home-header h2 {
  font-size: 32px;
  margin-bottom: 12px;
  color: var(--black);
  font-family: 'Times New Roman', serif;
}

.home-header p {
  font-size: 16px;
  color: var(--gray);
  max-width: 700px;
  margin: 0 auto;
}

.editions-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 15px;
  margin-top: 30px;
}

.edition-card {
  background-color: var(--white);
  border: 2px solid var(--gold);
  border-radius: 10px;
  padding: 25px 15px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  position: relative;
  overflow: hidden;
}

.edition-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(201, 164, 76, 0.15);
  background-color: var(--gold);
  color: var(--white);
}

.edition-card:hover .edition-year {
  color: var(--white);
}

.edition-year {
  font-size: 32px;
  font-weight: 700;
  color: var(--gold);
  margin-bottom: 5px;
  font-family: 'Times New Roman', serif;
  transition: color 0.3s;
}

.edition-label {
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 1.5px;
  opacity: 0.8;
}

/* Edition Page */
.edition-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 15px;
  border-bottom: 2px solid var(--gold);
  flex-wrap: wrap;
  gap: 15px;
}

.edition-header h2 {
  font-size: 32px;
  color: var(--black);
  font-family: 'Times New Roman', serif;
}

.back-button {
  background-color: var(--gold);
  color: var(--white);
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: background-color 0.3s;
  white-space: nowrap;
}

.back-button:hover {
  background-color: var(--gold-dark);
}

/* Categories */
.category-container {
  margin-bottom: 40px;
  background-color: var(--white);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.category-header {
  background-color: var(--gold);
  color: var(--white);
  padding: 15px 20px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.category-header:hover {
  background-color: var(--gold-dark);
}

.category-header h3 {
  font-size: 20px;
  font-family: 'Times New Roman', serif;
  margin: 0;
}

.category-toggle {
  font-size: 18px;
}

.nominees-list {
  padding: 15px;
}

.nominee-item {
  display: flex;
  align-items: center;
  padding: 12px;
  border-bottom: 1px solid var(--light-gray);
  transition: background-color 0.2s;
}

.nominee-item:last-child {
  border-bottom: none;
}

.nominee-item:hover {
  background-color: rgba(201, 164, 76, 0.05);
}

.winner {
  background-color: rgba(201, 164, 76, 0.1);
  border-left: 4px solid var(--gold);
}

.nominee-image {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--gold);
  margin-right: 15px;
  flex-shrink: 0;
  background-color: var(--light-gray);
}

.nominee-info {
  flex-grow: 1;
}

.nominee-name {
  font-weight: 600;
  font-size: 16px;
  margin-bottom: 3px;
  color: var(--black);
}

.nominee-work {
  color: var(--gray);
  font-size: 14px;
  margin-bottom: 3px;
  font-weight: 500;
}

.nominee-feature {
  color: var(--gray);
  font-size: 13px;
  font-style: italic;
}

.nominee-feature a {
  color: var(--gold);
  text-decoration: none;
}

.nominee-feature a:hover {
  text-decoration: underline;
}

.nominee-status {
  margin-left: 10px;
}

.status-badge {
  padding: 5px 12px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
  white-space: nowrap;
}

.winner-badge {
  background-color: var(--gold);
  color: var(--white);
}

.nominated-badge {
  background-color: var(--light-gray);
  color: var(--gray);
}

/* Artist Page - Grammy Style */
.artist-hero {
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 40px;
  margin-bottom: 50px;
  position: relative;
}

.artist-image-container {
  position: relative;
}

.artist-image {
  width: 100%;
  height: 400px;
  object-fit: cover;
  border-radius: 10px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
  position: relative;
  z-index: 1;
}

.artist-image-fade {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.9) 100%);
  border-radius: 10px;
  z-index: 2;
}

.artist-info {
  padding: 30px 0;
  position: relative;
  z-index: 3;
}

.artist-info h1 {
  font-size: 48px;
  margin-bottom: 15px;
  color: var(--black);
  font-family: 'Times New Roman', serif;
  font-weight: 700;
}

.artist-stats-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  margin: 30px 0;
}

.stat-card {
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
  text-align: center;
  border-top: 4px solid var(--gold);
}

.stat-number {
  font-size: 32px;
  font-weight: 700;
  color: var(--gold);
  margin-bottom: 5px;
}

.stat-label {
  font-size: 14px;
  color: var(--gray);
  font-weight: 600;
}

/* Artist Awards */
.awards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.award-item {
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  border-left: 4px solid var(--gold);
  transition: transform 0.2s;
}

.award-item:hover {
  transform: translateY(-3px);
}

.award-year {
  font-weight: 700;
  color: var(--gold);
  font-size: 16px;
  margin-bottom: 8px;
}

.award-category {
  font-weight: 600;
  font-size: 15px;
  margin-bottom: 5px;
  color: var(--black);
}

.award-work {
  color: var(--gray);
  font-size: 14px;
  margin-bottom: 10px;
}

/* Stats Section */
.stats-section {
  margin-top: 60px;
  padding-top: 40px;
  border-top: 2px solid var(--light-gray);
}

.stats-section h2 {
  font-size: 28px;
  margin-bottom: 30px;
  color: var(--black);
  font-family: 'Times New Roman', serif;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 40px;
}

.stat-record {
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  text-align: center;
}

.stat-record h3 {
  font-size: 16px;
  margin-bottom: 15px;
  color: var(--gray);
  font-weight: 600;
}

.record-item {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
  padding: 10px;
  background: var(--light-gray);
  border-radius: 8px;
}

.record-item img {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--gold);
}

.record-info {
  flex: 1;
}

.record-name {
  font-weight: 600;
  font-size: 14px;
  margin-bottom: 2px;
}

.record-count {
  font-size: 12px;
  color: var(--gold);
  font-weight: 700;
}

/* All Artists Page */
.artists-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 20px;
  margin-top: 30px;
}

.artist-card {
  background: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  transition: transform 0.3s;
  cursor: pointer;
}

.artist-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
}

.artist-card-image {
  width: 100%;
  height: 180px;
  object-fit: cover;
}

.artist-card-info {
  padding: 15px;
}

.artist-card-info h3 {
  font-size: 16px;
  margin-bottom: 8px;
  color: var(--black);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.artist-card-stats {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: var(--gray);
}

.artist-card-stat {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.artist-card-stat span:first-child {
  font-weight: 700;
  color: var(--gold);
  font-size: 14px;
}

/* Loading State */
.loading-container {
  text-align: center;
  padding: 40px 20px;
}

.loading-spinner {
  border: 4px solid rgba(201, 164, 76, 0.2);
  border-radius: 50%;
  border-top: 4px solid var(--gold);
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin: 0 auto 15px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loading-text {
  font-size: 16px;
  color: var(--gray);
}

/* Error State */
.error-container {
  text-align: center;
  padding: 40px 20px;
  background-color: #fff5f5;
  border-radius: 10px;
  border: 1px solid #fed7d7;
}

.error-icon {
  font-size: 40px;
  color: #e53e3e;
  margin-bottom: 15px;
}

.error-text {
  font-size: 16px;
  color: #c53030;
  margin-bottom: 15px;
}

.retry-button {
  background-color: #e53e3e;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: var(--gray);
  font-size: 16px;
}

/* Footer */
footer {
  background-color: var(--dark);
  color: var(--white);
  padding: 25px 20px;
  text-align: center;
  margin-top: 50px;
}

.footer-content {
  max-width: 1200px;
  margin: 0 auto;
}

.footer-links {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin: 15px 0;
  flex-wrap: wrap;
}

.footer-links a {
  color: var(--gold);
  text-decoration: none;
  transition: color 0.3s;
  font-size: 14px;
}

.footer-links a:hover {
  color: var(--white);
}

.copyright {
  color: #999;
  font-size: 13px;
  margin-top: 15px;
}

/* Responsive */
@media (max-width: 1024px) {
  .artist-hero {
    grid-template-columns: 1fr;
  }
  
  .artist-image-fade {
    background: linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,0.9) 100%);
  }
}

@media (max-width: 768px) {
  .header-container {
    flex-direction: column;
    gap: 15px;
  }
  
  nav ul {
    justify-content: center;
    gap: 15px;
  }
  
  .search-container {
    max-width: 100%;
    margin-left: 0;
  }
  
  .artist-hero {
    gap: 20px;
  }
  
  .artist-info h1 {
    font-size: 36px;
  }
  
  .artist-stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
  }
  
  .awards-grid {
    grid-template-columns: 1fr;
  }
  
  .artists-grid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  }
}

@media (max-width: 480px) {
  .artist-stats-grid {
    grid-template-columns: 1fr;
  }
  
  .editions-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .artist-card-image {
    height: 150px;
  }
}
</style>
</head>
<body>
<header>
  <div class="header-container">
    <div class="logo">
      <i class="fas fa-trophy logo-icon"></i>
      <h1>DAEGON AWARDS</h1>
    </div>
    
    <nav>
      <ul>
        <li><a href="#" id="homeLink" class="active">Home</a></li>
        <li><a href="#" id="browseCategories">Categories</a></li>
        <li><a href="#" id="browseArtists">Artists</a></li>
        <li><a href="#" id="statsLink">Stats</a></li>
        <li><a href="#" id="aboutLink">About</a></li>
      </ul>
    </nav>
    
    <div class="search-container">
      <div class="search-box">
        <input type="text" id="searchInput" placeholder="Search artists, songs, albums...">
        <i class="fas fa-search"></i>
        <div class="search-results" id="searchResults"></div>
      </div>
    </div>
  </div>
</header>

<main>
  <!-- Home Section -->
  <section id="home" class="container">
    <div class="home-header">
      <h2>Daegon Music Awards</h2>
      <p>Celebrating excellence in music across multiple genres and categories. Explore past editions, winners, and nominees.</p>
    </div>
    
    <div class="editions-grid" id="editionsGrid">
      <!-- Edition cards will be populated by JavaScript -->
    </div>
  </section>

  <!-- Edition Section -->
  <section id="edition" class="container hidden">
    <div class="edition-header">
      <h2 id="editionTitle">Daegon Awards</h2>
      <button class="back-button" id="backButton">
        <i class="fas fa-arrow-left"></i> Back to Home
      </button>
    </div>
    
    <div id="editionContent">
      <div class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading award data...</div>
      </div>
    </div>
  </section>

  <!-- Category Section -->
  <section id="category" class="container hidden">
    <div class="edition-header">
      <h2 id="categoryTitle">Category</h2>
      <button class="back-button" id="backButtonCategory">
        <i class="fas fa-arrow-left"></i> Back
      </button>
    </div>
    
    <div id="categoryContent">
      <div class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading category data...</div>
      </div>
    </div>
  </section>

  <!-- Categories Browse Section -->
  <section id="categoriesBrowse" class="container hidden">
    <div class="edition-header">
      <h2>All Categories</h2>
      <button class="back-button" id="backButtonCategories">
        <i class="fas fa-arrow-left"></i> Back to Home
      </button>
    </div>
    
    <div id="categoriesContent">
      <div class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading categories...</div>
      </div>
    </div>
  </section>

  <!-- Artists Browse Section -->
  <section id="artistsBrowse" class="container hidden">
    <div class="edition-header">
      <h2>All Artists</h2>
      <button class="back-button" id="backButtonArtists">
        <i class="fas fa-arrow-left"></i> Back to Home
      </button>
    </div>
    
    <div id="artistsContent">
      <div class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading artists...</div>
      </div>
    </div>
  </section>

  <!-- Artist Section -->
  <section id="artist" class="container hidden">
    <div class="edition-header">
      <h2 id="artistTitle">Artist Profile</h2>
      <button class="back-button" id="backButtonArtist">
        <i class="fas fa-arrow-left"></i> Back
      </button>
    </div>
    
    <div id="artistContent">
      <div class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading artist data...</div>
      </div>
    </div>
  </section>

  <!-- Stats Section -->
  <section id="stats" class="container hidden">
    <div class="edition-header">
      <h2>Award Statistics</h2>
      <button class="back-button" id="backButtonStats">
        <i class="fas fa-arrow-left"></i> Back to Home
      </button>
    </div>
    
    <div id="statsContent">
      <div class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading statistics...</div>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section id="about" class="container hidden">
    <div class="edition-header">
      <h2>About Daegon Awards</h2>
      <button class="back-button" id="backButtonAbout">
        <i class="fas fa-arrow-left"></i> Back to Home
      </button>
    </div>
    
    <div style="max-width: 800px; margin: 0 auto;">
      <div style="margin-bottom: 40px;">
        <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--black);">Our Mission</h3>
        <p style="font-size: 16px; line-height: 1.7; color: var(--gray);">
          The Daegon Awards were established to recognize and celebrate exceptional talent in the music industry. 
          Our goal is to honor artists, producers, and contributors who have made significant impacts through their creative work.
        </p>
      </div>
      
      <div style="margin-bottom: 40px;">
        <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--black);">Selection Process</h3>
        <p style="font-size: 16px; line-height: 1.7; color: var(--gray);">
          Nominees are selected by a panel of industry experts, and winners are chosen based on artistic merit, 
          innovation, and cultural impact. The process is designed to be fair, transparent, and comprehensive.
        </p>
      </div>
      
      <div>
        <h3 style="font-size: 24px; margin-bottom: 15px; color: var(--black);">Data Source</h3>
        <p style="font-size: 16px; line-height: 1.7; color: var(--gray); margin-bottom: 20px;">
          All award data is sourced from publicly available Google Sheets that document the nominations and winners 
          for each edition of the Daegon Awards from 2017 to 2025.
        </p>
        <a href="https://docs.google.com/spreadsheets/d/1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk" 
           target="_blank" 
           style="display: inline-flex; align-items: center; gap: 10px; background-color: var(--gold); color: white; padding: 12px 24px; border-radius: 6px; text-decoration: none; font-weight: 600;">
          <i class="fas fa-external-link-alt"></i> View Data Source
        </a>
      </div>
    </div>
  </section>
</main>

<footer>
  <div class="footer-content">
    <div class="logo" style="justify-content: center;">
      <i class="fas fa-trophy logo-icon"></i>
      <h1 style="color: white;">DAEGON AWARDS</h1>
    </div>
    
    <div class="footer-links">
      <a href="#" id="footerHome">Home</a>
      <a href="#" id="footerCategories">Categories</a>
      <a href="#" id="footerArtists">Artists</a>
      <a href="#" id="footerStats">Stats</a>
      <a href="#" id="footerAbout">About</a>
      <a href="https://docs.google.com/spreadsheets/d/1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk" target="_blank">Data Source</a>
    </div>
    
    <div class="copyright">
      © 2023 Daegon Awards. All data is for demonstration purposes.
    </div>
  </div>
</footer>

<script>
// ================= CONSTANTS AND DATA =================
const EDITIONS = {
  2017: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "0",
    name: "2017 Edition"
  },
  2018: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "912023648",
    name: "2018 Edition"
  },
  2019: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "221365296",
    name: "2019 Edition"
  },
  2020: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "1123138246",
    name: "2020 Edition"
  },
  2021: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "919977085",
    name: "2021 Edition"
  },
  2022: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "2065423547",
    name: "2022 Edition"
  },
  2023: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "1803569858",
    name: "2023 Edition"
  },
  2024: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "1350904783",
    name: "2024 Edition"
  },
  2025: {
    sheetId: "1DNb6uYi6K231-fhrSt3XPlaag8eG9ZFVHhvSXyjWCuk",
    gid: "1189047483",
    name: "2025 Edition"
  }
};

const NO_FEAT_CATEGORIES = ["Artist of the Year", "Best New Artist"];
const GENRES = {
  pop: ["Pop", "Pop Vocal", "Pop Album", "Pop Song", "Pop Collaboration"],
  rnb: ["R&B", "R&B Song", "R&B Album", "R&B Performance", "Urban", "Soul"],
  alternative: ["Alternative", "Rock", "Indie", "Alternative Album", "Rock Album"],
  rap: ["Rap", "Hip Hop", "Rap Album", "Rap Song", "Rap Performance"],
  country: ["Country", "Country Song", "Country Album", "Country Performance"],
  dance: ["Dance", "Electronic", "Dance Recording", "Dance Album"],
  latin: ["Latin", "Latin Pop", "Latin Rock", "Regional Mexican"],
  global: ["Global", "World Music", "Reggae", "African"]
};

// Global data cache
const dataCache = {};
const artistCache = {};
const statsCache = {};

// Image cache with timeout
const imageCache = new Map();
const IMAGE_CACHE_TIMEOUT = 3600000; // 1 hour

// DOM Elements
const sections = {
  home: document.getElementById('home'),
  edition: document.getElementById('edition'),
  category: document.getElementById('category'),
  categoriesBrowse: document.getElementById('categoriesBrowse'),
  artistsBrowse: document.getElementById('artistsBrowse'),
  artist: document.getElementById('artist'),
  stats: document.getElementById('stats'),
  about: document.getElementById('about')
};

const contentElements = {
  editionContent: document.getElementById('editionContent'),
  categoryContent: document.getElementById('categoryContent'),
  categoriesContent: document.getElementById('categoriesContent'),
  artistsContent: document.getElementById('artistsContent'),
  artistContent: document.getElementById('artistContent'),
  statsContent: document.getElementById('statsContent')
};

const titleElements = {
  editionTitle: document.getElementById('editionTitle'),
  categoryTitle: document.getElementById('categoryTitle'),
  artistTitle: document.getElementById('artistTitle')
};

const editionsGrid = document.getElementById('editionsGrid');
const searchInput = document.getElementById('searchInput');
const searchResults = document.getElementById('searchResults');

// Navigation elements
const navElements = {
  homeLink: document.getElementById('homeLink'),
  browseCategories: document.getElementById('browseCategories'),
  browseArtists: document.getElementById('browseArtists'),
  statsLink: document.getElementById('statsLink'),
  aboutLink: document.getElementById('aboutLink')
};

const footerElements = {
  footerHome: document.getElementById('footerHome'),
  footerCategories: document.getElementById('footerCategories'),
  footerArtists: document.getElementById('footerArtists'),
  footerStats: document.getElementById('footerStats'),
  footerAbout: document.getElementById('footerAbout')
};

// Back buttons
const backButtons = {
  backButton: document.getElementById('backButton'),
  backButtonCategory: document.getElementById('backButtonCategory'),
  backButtonCategories: document.getElementById('backButtonCategories'),
  backButtonArtists: document.getElementById('backButtonArtists'),
  backButtonArtist: document.getElementById('backButtonArtist'),
  backButtonStats: document.getElementById('backButtonStats'),
  backButtonAbout: document.getElementById('backButtonAbout')
};

// ================= PERFORMANCE OPTIMIZATIONS =================
// Debounce function for search
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

// Image placeholder generator
function generatePlaceholderImage(name, size = 150) {
  if (!name) name = '?';
  
  const words = name.split(' ').filter(w => w.length > 0);
  let initials = words.length === 1 ? 
    words[0].substring(0, 2).toUpperCase() : 
    (words[0][0] + words[words.length - 1][0]).toUpperCase();
  
  const colors = ['#c9a44c', '#2c3e50', '#3498db', '#e74c3c', '#2ecc71'];
  const hash = name.split('').reduce((a, b) => a + b.charCodeAt(0), 0);
  const color = colors[hash % colors.length];
  
  const svg = `<svg xmlns="http://www.w3.org/2000/svg" width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
    <circle cx="${size/2}" cy="${size/2}" r="${size/2}" fill="${color}"/>
    <text x="${size/2}" y="${size/2 + size/20}" text-anchor="middle" fill="white" font-family="Arial" font-size="${size/3}" font-weight="bold">${initials}</text>
  </svg>`;
  
  return `data:image/svg+xml;utf8,${encodeURIComponent(svg)}`;
}

// Get artist image with caching
async function getArtistImage(artistName, size = 150) {
  if (!artistName) return generatePlaceholderImage('?', size);
  
  const cacheKey = `${artistName}-${size}`;
  const now = Date.now();
  
  // Check cache
  if (imageCache.has(cacheKey)) {
    const cached = imageCache.get(cacheKey);
    if (now - cached.timestamp < IMAGE_CACHE_TIMEOUT) {
      return cached.url;
    }
  }
  
  // Try MusicBrainz API
  try {
    const mbUrl = `https://musicbrainz.org/ws/2/artist/?query=artist:${encodeURIComponent(artistName)}&fmt=json&limit=1`;
    const response = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(mbUrl)}`);
    
    if (response.ok) {
      const data = await response.json();
      if (data.artists && data.artists.length > 0) {
        const artist = data.artists[0];
        if (artist.id) {
          // Try to get image from Cover Art Archive
          const coverUrl = `https://coverartarchive.org/artist/${artist.id}`;
          const coverResponse = await fetch(coverUrl);
          
          if (coverResponse.ok) {
            const coverData = await coverResponse.json();
            if (coverData.images && coverData.images.length > 0) {
              const imageUrl = coverData.images[0].thumbnails.small || coverData.images[0].image;
              imageCache.set(cacheKey, { url: imageUrl, timestamp: now });
              return imageUrl;
            }
          }
        }
      }
    }
  } catch (error) {
    console.log('MusicBrainz fetch failed:', error.message);
  }
  
  // Fallback: Try Last.fm
  try {
    const lastfmUrl = `https://ws.audioscrobbler.com/2.0/?method=artist.getinfo&artist=${encodeURIComponent(artistName)}&api_key=cab20e6e8c9fb5b8a4c9b9297833fa7b&format=json`;
    const response = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(lastfmUrl)}`);
    
    if (response.ok) {
      const data = await response.json();
      if (data.artist && data.artist.image && data.artist.image.length > 0) {
        const imageUrl = data.artist.image[3]['#text']; // Large size
        if (imageUrl) {
          imageCache.set(cacheKey, { url: imageUrl, timestamp: now });
          return imageUrl;
        }
      }
    }
  } catch (error) {
    console.log('Last.fm fetch failed:', error.message);
  }
  
  // Ultimate fallback: Wikipedia
  try {
    const wikiUrl = `https://en.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(artistName)}&prop=pageimages&format=json&pithumbsize=${size}&origin=*`;
    const response = await fetch(wikiUrl);
    
    if (response.ok) {
      const data = await response.json();
      const pages = data.query?.pages;
      if (pages) {
        const page = Object.values(pages)[0];
        if (page?.thumbnail?.source) {
          imageCache.set(cacheKey, { url: page.thumbnail.source, timestamp: now });
          return page.thumbnail.source;
        }
      }
    }
  } catch (error) {
    console.log('Wikipedia fetch failed:', error.message);
  }
  
  // Use placeholder
  const placeholder = generatePlaceholderImage(artistName, size);
  imageCache.set(cacheKey, { url: placeholder, timestamp: now });
  return placeholder;
}

// ================= DATA FETCHING WITH CACHING =================
async function fetchSheetData(year) {
  const cacheKey = `edition-${year}`;
  
  // Check memory cache
  if (dataCache[cacheKey]) {
    return dataCache[cacheKey];
  }
  
  // Check localStorage cache
  const localStorageKey = `daegon-data-${year}`;
  const cachedData = localStorage.getItem(localStorageKey);
  if (cachedData) {
    try {
      const parsed = JSON.parse(cachedData);
      const cacheAge = Date.now() - parsed.timestamp;
      
      // Use cache if less than 1 hour old
      if (cacheAge < 3600000) {
        dataCache[cacheKey] = parsed.data;
        console.log(`Loaded ${year} from localStorage cache`);
        return parsed.data;
      }
    } catch (e) {
      // Cache corrupted, continue to fetch
    }
  }
  
  console.log(`Fetching data for ${year}...`);
  
  const edition = EDITIONS[year];
  if (!edition) throw new Error(`Edition ${year} not found`);
  
  try {
    // Optimized fetch with timeout
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), 10000);
    
    const url = `https://docs.google.com/spreadsheets/d/${edition.sheetId}/gviz/tq?tqx=out:json&gid=${edition.gid}`;
    const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
    
    const response = await fetch(proxyUrl, { signal: controller.signal });
    clearTimeout(timeoutId);
    
    if (!response.ok) throw new Error(`HTTP ${response.status}`);
    
    const text = await response.text();
    const jsonStart = text.indexOf('{');
    const jsonEnd = text.lastIndexOf('}') + 1;
    
    if (jsonStart === -1 || jsonEnd === -1) {
      throw new Error('Invalid response format');
    }
    
    const jsonText = text.substring(jsonStart, jsonEnd);
    const data = JSON.parse(jsonText);
    
    if (!data.table?.rows) {
      return { categories: {}, order: [] };
    }
    
    // Process data (skip header row)
    const rows = data.table.rows;
    const categories = {};
    const categoryOrder = [];
    const seenCategories = new Set();
    
    for (let i = 1; i < rows.length; i++) {
      const row = rows[i];
      const cells = row.c || [];
      
      const category = cells[0]?.v || '';
      const item = cells[1]?.v || '';
      const artist = cells[2]?.v || '';
      const feature = cells[3]?.v || '';
      const status = cells[4]?.v || '';
      
      if (!category) continue;
      
      if (!seenCategories.has(category)) {
        seenCategories.add(category);
        categoryOrder.push(category);
      }
      
      if (!categories[category]) {
        categories[category] = [];
      }
      
      categories[category].push({
        item: item.trim(),
        artist: artist.trim(),
        feature: feature.trim(),
        status: status.toLowerCase().includes('win') ? 'Winner' : 'Nominated',
        year: parseInt(year)
      });
    }
    
    const result = { categories, order: categoryOrder };
    
    // Cache in memory and localStorage
    dataCache[cacheKey] = result;
    localStorage.setItem(localStorageKey, JSON.stringify({
      data: result,
      timestamp: Date.now()
    }));
    
    console.log(`${year}: ${Object.keys(categories).length} categories, ${Object.values(categories).reduce((sum, arr) => sum + arr.length, 0)} entries`);
    
    return result;
  } catch (error) {
    console.error(`Error fetching ${year}:`, error);
    
    // Try fallback method
    try {
      const fallbackUrl = `https://sheets.googleapis.com/v4/spreadsheets/${edition.sheetId}/values/${year}!A:E?key=AIzaSyB1rhkWVvHcFQsZ6D0y9C2enIKdKe7vE0g`;
      const response = await fetch(fallbackUrl, { signal: AbortSignal.timeout(10000) });
      
      if (response.ok) {
        const data = await response.json();
        if (data.values) {
          const rows = data.values.slice(1); // Skip header
          const categories = {};
          const categoryOrder = [];
          const seenCategories = new Set();
          
          rows.forEach(row => {
            const category = row[0] || '';
            const item = row[1] || '';
            const artist = row[2] || '';
            const feature = row[3] || '';
            const status = row[4] || '';
            
            if (!category) return;
            
            if (!seenCategories.has(category)) {
              seenCategories.add(category);
              categoryOrder.push(category);
            }
            
            if (!categories[category]) {
              categories[category] = [];
            }
            
            categories[category].push({
              item: item.trim(),
              artist: artist.trim(),
              feature: feature.trim(),
              status: status.toLowerCase().includes('win') ? 'Winner' : 'Nominated',
              year: parseInt(year)
            });
          });
          
          const result = { categories, order: categoryOrder };
          dataCache[cacheKey] = result;
          return result;
        }
      }
    } catch (fallbackError) {
      console.error(`Fallback also failed for ${year}:`, fallbackError);
    }
    
    throw error;
  }
}

// Load all data efficiently
async function loadAllData() {
  const years = Object.keys(EDITIONS).sort((a, b) => b - a);
  const promises = years.map(year => fetchSheetData(year).catch(err => {
    console.warn(`Failed to load ${year}:`, err.message);
    return null;
  }));
  
  const results = await Promise.all(promises);
  return results.filter(r => r !== null);
}

// ================= ARTIST STATS AND DATA =================
async function getAllArtistsData() {
  if (artistCache.allArtists) {
    return artistCache.allArtists;
  }
  
  const allData = await loadAllData();
  const artistsMap = new Map();
  
  allData.forEach(editionData => {
    if (!editionData) return;
    
    Object.values(editionData.categories).forEach(nominees => {
      nominees.forEach(nominee => {
        if (!nominee.artist) return;
        
        // Main artist
        if (!artistsMap.has(nominee.artist)) {
          artistsMap.set(nominee.artist, {
            name: nominee.artist,
            nominations: 0,
            wins: 0,
            nominationsByYear: {},
            winsByYear: {},
            categories: new Set(),
            works: new Set()
          });
        }
        
        const artist = artistsMap.get(nominee.artist);
        artist.nominations++;
        artist.categories.add(nominee.category || 'Unknown');
        if (nominee.item) artist.works.add(nominee.item);
        
        if (nominee.status === 'Winner') {
          artist.wins++;
          if (!artist.winsByYear[nominee.year]) artist.winsByYear[nominee.year] = 0;
          artist.winsByYear[nominee.year]++;
        }
        
        if (!artist.nominationsByYear[nominee.year]) artist.nominationsByYear[nominee.year] = 0;
        artist.nominationsByYear[nominee.year]++;
        
        // Featured artists
        if (nominee.feature) {
          const featuredArtists = nominee.feature.split(',').map(f => f.trim()).filter(f => f);
          featuredArtists.forEach(featuredArtist => {
            if (!artistsMap.has(featuredArtist)) {
              artistsMap.set(featuredArtist, {
                name: featuredArtist,
                nominations: 0,
                wins: 0,
                nominationsByYear: {},
                winsByYear: {},
                categories: new Set(),
                works: new Set()
              });
            }
            
            const featured = artistsMap.get(featuredArtist);
            featured.nominations++;
            featured.categories.add(nominee.category || 'Unknown');
            
            if (nominee.status === 'Winner') {
              featured.wins++;
              if (!featured.winsByYear[nominee.year]) featured.winsByYear[nominee.year] = 0;
              featured.winsByYear[nominee.year]++;
            }
            
            if (!featured.nominationsByYear[nominee.year]) featured.nominationsByYear[nominee.year] = 0;
            featured.nominationsByYear[nominee.year]++;
          });
        }
      });
    });
  });
  
  const artists = Array.from(artistsMap.values())
    .map(artist => ({
      ...artist,
      categories: Array.from(artist.categories),
      works: Array.from(artist.works).slice(0, 10) // Limit works
    }))
    .sort((a, b) => b.nominations - a.nominations || b.wins - a.wins);
  
  artistCache.allArtists = artists;
  return artists;
}

// ================= STATISTICS =================
async function getStatistics() {
  if (statsCache.all) {
    return statsCache.all;
  }
  
  const artists = await getAllArtistsData();
  const allData = await loadAllData();
  
  // Most wins overall
  const mostWins = [...artists].sort((a, b) => b.wins - a.wins).slice(0, 10);
  
  // Most nominations overall
  const mostNominations = [...artists].sort((a, b) => b.nominations - a.nominations).slice(0, 10);
  
  // Wins by year
  const winsByYear = {};
  const nominationsByYear = {};
  
  artists.forEach(artist => {
    Object.entries(artist.winsByYear).forEach(([year, count]) => {
      if (!winsByYear[year]) winsByYear[year] = [];
      winsByYear[year].push({ name: artist.name, count });
    });
    
    Object.entries(artist.nominationsByYear).forEach(([year, count]) => {
      if (!nominationsByYear[year]) nominationsByYear[year] = [];
      nominationsByYear[year].push({ name: artist.name, count });
    });
  });
  
  // Sort yearly winners
  Object.keys(winsByYear).forEach(year => {
    winsByYear[year].sort((a, b) => b.count - a.count);
  });
  
  Object.keys(nominationsByYear).forEach(year => {
    nominationsByYear[year].sort((a, b) => b.count - a.count);
  });
  
  // By genre
  const genreStats = {};
  Object.keys(GENRES).forEach(genre => {
    genreStats[genre] = {
      wins: [],
      nominations: []
    };
  });
  
  artists.forEach(artist => {
    artist.categories.forEach(category => {
      Object.entries(GENRES).forEach(([genre, genreCategories]) => {
        if (genreCategories.some(gc => category.includes(gc))) {
          if (!genreStats[genre].wins.find(a => a.name === artist.name)) {
            genreStats[genre].wins.push({ name: artist.name, count: artist.wins });
            genreStats[genre].nominations.push({ name: artist.name, count: artist.nominations });
          }
        }
      });
    });
  });
  
  // Sort genre stats
  Object.keys(genreStats).forEach(genre => {
    genreStats[genre].wins.sort((a, b) => b.count - a.count);
    genreStats[genre].nominations.sort((a, b) => b.count - a.count);
  });
  
  const stats = {
    mostWins,
    mostNominations,
    winsByYear,
    nominationsByYear,
    genreStats,
    totalArtists: artists.length,
    totalNominations: artists.reduce((sum, a) => sum + a.nominations, 0),
    totalWins: artists.reduce((sum, a) => sum + a.wins, 0)
  };
  
  statsCache.all = stats;
  return stats;
}

// ================= SEARCH FUNCTIONALITY =================
async function performSearch(query) {
  if (!query || query.length < 2) {
    searchResults.style.display = 'none';
    return;
  }
  
  const artists = await getAllArtistsData();
  const allData = await loadAllData();
  
  const searchTerm = query.toLowerCase();
  const results = [];
  
  // Search artists
  artists.forEach(artist => {
    if (artist.name.toLowerCase().includes(searchTerm)) {
      results.push({
        type: 'artist',
        name: artist.name,
        wins: artist.wins,
        nominations: artist.nominations,
        match: artist.name
      });
    }
  });
  
  // Search works from all data
  allData.forEach(editionData => {
    if (!editionData) return;
    
    Object.values(editionData.categories).forEach(nominees => {
      nominees.forEach(nominee => {
        if (nominee.item && nominee.item.toLowerCase().includes(searchTerm)) {
          results.push({
            type: 'work',
            name: nominee.item,
            artist: nominee.artist,
            year: nominee.year,
            category: Object.keys(editionData.categories).find(cat => 
              editionData.categories[cat].includes(nominee)
            ),
            match: nominee.item
          });
        }
      });
    });
  });
  
  // Limit results
  const limitedResults = results.slice(0, 20);
  
  // Display results
  if (limitedResults.length === 0) {
    searchResults.innerHTML = '<div class="search-result-item">No results found</div>';
  } else {
    searchResults.innerHTML = limitedResults.map(result => {
      if (result.type === 'artist') {
        return `
          <div class="search-result-item" onclick="openArtist('${encodeURIComponent(result.name)}')">
            <img src="${generatePlaceholderImage(result.name, 40)}" alt="${result.name}">
            <div class="search-result-info">
              <h4>${result.name}</h4>
              <p>${result.wins} wins • ${result.nominations} nominations</p>
            </div>
          </div>
        `;
      } else {
        return `
          <div class="search-result-item" onclick="openArtist('${encodeURIComponent(result.artist)}')">
            <img src="${generatePlaceholderImage(result.artist, 40)}" alt="${result.artist}">
            <div class="search-result-info">
              <h4>${result.name}</h4>
              <p>${result.artist} • ${result.year} • ${result.category}</p>
            </div>
          </div>
        `;
      }
    }).join('');
  }
  
  searchResults.style.display = 'block';
}

// ================= UI FUNCTIONS =================
function showSection(sectionName) {
  Object.values(sections).forEach(section => section.classList.add('hidden'));
  sections[sectionName].classList.remove('hidden');
  
  // Update nav
  Object.values(navElements).forEach(link => link.classList.remove('active'));
  if (navElements[`${sectionName}Link`]) {
    navElements[`${sectionName}Link`].classList.add('active');
  }
}

// Initialize edition cards
function initializeEditionCards() {
  const years = Object.keys(EDITIONS).sort((a, b) => b - a);
  editionsGrid.innerHTML = years.map(year => `
    <div class="edition-card" data-year="${year}">
      <div class="edition-year">${year}</div>
      <div class="edition-label">EDITION</div>
    </div>
  `).join('');
}

// Load edition page
async function openEdition(year) {
  showSection('edition');
  titleElements.editionTitle.textContent = `Daegon Awards ${year}`;
  contentElements.editionContent.innerHTML = `
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading award data...</div>
    </div>
  `;
  
  try {
    const data = await fetchSheetData(year);
    const { categories, order } = data;
    
    if (Object.keys(categories).length === 0) {
      contentElements.editionContent.innerHTML = `
        <div class="empty-state">
          <i class="fas fa-trophy" style="font-size: 48px; color: var(--gold); margin-bottom: 20px;"></i>
          <p>No data available for the ${year} edition.</p>
        </div>
      `;
      return;
    }
    
    let html = '';
    const sortedCategories = order.length > 0 ? order : Object.keys(categories).sort();
    
    sortedCategories.forEach(categoryName => {
      const nominees = categories[categoryName] || [];
      if (nominees.length === 0) return;
      
      nominees.sort((a, b) => {
        if (a.status === 'Winner' && b.status !== 'Winner') return -1;
        if (a.status !== 'Winner' && b.status === 'Winner') return 1;
        return a.artist.localeCompare(b.artist);
      });
      
      html += `
        <div class="category-container">
          <div class="category-header" onclick="toggleCategory('${year}-${categoryName}')">
            <h3>${categoryName} (${nominees.length})</h3>
            <span class="category-toggle">+</span>
          </div>
          <div class="nominees-list" id="category-${year}-${categoryName.replace(/[^a-zA-Z0-9]/g, '-')}">
            ${nominees.map(nominee => {
              const isWinner = nominee.status === 'Winner';
              const showFeature = nominee.feature && !NO_FEAT_CATEGORIES.includes(categoryName);
              
              return `
                <div class="nominee-item ${isWinner ? 'winner' : ''}">
                  <img src="${generatePlaceholderImage(nominee.artist, 50)}" 
                       alt="${nominee.artist}" 
                       class="nominee-image"
                       data-artist="${nominee.artist}"
                       onload="loadRealImage(this)">
                  <div class="nominee-info">
                    <div class="nominee-name">
                      <a href="#" onclick="openArtist('${encodeURIComponent(nominee.artist)}'); return false;">
                        ${nominee.artist || 'Unknown'}
                      </a>
                    </div>
                    ${nominee.item ? `<div class="nominee-work">${nominee.item}</div>` : ''}
                    ${showFeature && nominee.feature ? `
                      <div class="nominee-feature">
                        feat. ${nominee.feature.split(',').map(f => 
                          `<a href="#" onclick="openArtist('${encodeURIComponent(f.trim())}'); return false;">${f.trim()}</a>`
                        ).join(', ')}
                      </div>
                    ` : ''}
                  </div>
                  <div class="nominee-status">
                    <span class="status-badge ${isWinner ? 'winner-badge' : 'nominated-badge'}">
                      ${isWinner ? 'Winner' : 'Nominated'}
                    </span>
                  </div>
                </div>
              `;
            }).join('')}
          </div>
        </div>
      `;
    });
    
    contentElements.editionContent.innerHTML = html;
    
    // Load real images in background
    setTimeout(() => {
      document.querySelectorAll('img[data-artist]').forEach(img => {
        const artist = img.getAttribute('data-artist');
        if (artist) {
          getArtistImage(artist, 50).then(src => {
            if (src && !src.includes('data:image/svg+xml')) {
              img.src = src;
            }
          });
        }
      });
    }, 100);
  } catch (error) {
    contentElements.editionContent.innerHTML = `
      <div class="error-container">
        <div class="error-icon"><i class="fas fa-exclamation-triangle"></i></div>
        <div class="error-text">Failed to load edition data</div>
        <button class="retry-button" onclick="openEdition('${year}')">
          <i class="fas fa-redo"></i> Retry
        </button>
      </div>
    `;
  }
}

// Load artist page (Grammy style)
async function openArtist(encodedName) {
  const artistName = decodeURIComponent(encodedName);
  showSection('artist');
  titleElements.artistTitle.textContent = artistName;
  
  contentElements.artistContent.innerHTML = `
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading artist data...</div>
    </div>
  `;
  
  try {
    const artists = await getAllArtistsData();
    const artist = artists.find(a => a.name === artistName);
    
    if (!artist) {
      contentElements.artistContent.innerHTML = `
        <div class="empty-state">
          <i class="fas fa-user"></i>
          <p>Artist not found</p>
        </div>
      `;
      return;
    }
    
    // Get artist image
    const imageUrl = await getArtistImage(artistName, 300);
    
    // Get artist awards
    const allData = await loadAllData();
    const awards = [];
    
    allData.forEach(editionData => {
      if (!editionData) return;
      
      Object.entries(editionData.categories).forEach(([category, nominees]) => {
        nominees.forEach(nominee => {
          if (nominee.artist === artistName || 
              (nominee.feature && nominee.feature.split(',').map(f => f.trim()).includes(artistName))) {
            
            const role = nominee.artist === artistName ? 'Main Artist' : 'Featured Artist';
            awards.push({
              year: nominee.year,
              category,
              item: nominee.item,
              status: nominee.status,
              role
            });
          }
        });
      });
    });
    
    awards.sort((a, b) => b.year - a.year || (a.status === 'Winner' ? -1 : 1));
    
    // Get statistics for this artist
    const stats = await getStatistics();
    
    // Build the page
    let html = `
      <div class="artist-hero">
        <div class="artist-image-container">
          <img src="${imageUrl}" alt="${artistName}" class="artist-image">
          <div class="artist-image-fade"></div>
        </div>
        
        <div class="artist-info">
          <h1>${artistName}</h1>
          
          <div class="artist-stats-grid">
            <div class="stat-card">
              <div class="stat-number">${artist.wins}</div>
              <div class="stat-label">Wins</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">${artist.nominations}</div>
              <div class="stat-label">Nominations</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">${artist.categories.length}</div>
              <div class="stat-label">Categories</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">${Object.keys(artist.nominationsByYear).length}</div>
              <div class="stat-label">Editions</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="awards-section">
        <h2 style="font-size: 24px; margin-bottom: 20px; color: var(--black);">Awards & Nominations</h2>
        <div class="awards-grid">
          ${awards.map(award => `
            <div class="award-item">
              <div class="award-year">${award.year}</div>
              <div class="award-category">${award.category}</div>
              ${award.item ? `<div class="award-work">${award.item}</div>` : ''}
              <div style="margin-top: 10px;">
                <span class="award-status" style="background-color: ${award.status === 'Winner' ? 'var(--gold)' : 'var(--light-gray)'}; color: ${award.status === 'Winner' ? 'white' : 'var(--gray)'};">
                  ${award.status} • ${award.role}
                </span>
              </div>
            </div>
          `).join('')}
        </div>
      </div>
    `;
    
    // Add statistics section
    html += `
      <div class="stats-section">
        <h2>Record Statistics</h2>
        
        <div class="stats-grid">
          <!-- Most Wins Overall -->
          <div class="stat-record">
            <h3>Most Wins Overall</h3>
            ${stats.mostWins.slice(0, 5).map((record, i) => `
              <div class="record-item">
                <img src="${generatePlaceholderImage(record.name, 40)}" alt="${record.name}">
                <div class="record-info">
                  <div class="record-name">${record.name}</div>
                  <div class="record-count">${record.count} wins</div>
                </div>
                ${i === 0 ? '<i class="fas fa-trophy" style="color: var(--gold);"></i>' : ''}
              </div>
            `).join('')}
          </div>
          
          <!-- Most Nominations Overall -->
          <div class="stat-record">
            <h3>Most Nominations Overall</h3>
            ${stats.mostNominations.slice(0, 5).map((record, i) => `
              <div class="record-item">
                <img src="${generatePlaceholderImage(record.name, 40)}" alt="${record.name}">
                <div class="record-info">
                  <div class="record-name">${record.name}</div>
                  <div class="record-count">${record.count} nominations</div>
                </div>
                ${i === 0 ? '<i class="fas fa-star" style="color: var(--gold);"></i>' : ''}
              </div>
            `).join('')}
          </div>
          
          <!-- Pop Genre -->
          <div class="stat-record">
            <h3>Pop Records</h3>
            ${stats.genreStats.pop?.wins.slice(0, 5).map((record, i) => `
              <div class="record-item">
                <img src="${generatePlaceholderImage(record.name, 40)}" alt="${record.name}">
                <div class="record-info">
                  <div class="record-name">${record.name}</div>
                  <div class="record-count">${record.count} wins</div>
                </div>
              </div>
            `).join('') || '<p style="color: var(--gray); font-size: 14px;">No data</p>'}
          </div>
          
          <!-- R&B Genre -->
          <div class="stat-record">
            <h3>R&B Records</h3>
            ${stats.genreStats.rnb?.wins.slice(0, 5).map((record, i) => `
              <div class="record-item">
                <img src="${generatePlaceholderImage(record.name, 40)}" alt="${record.name}">
                <div class="record-info">
                  <div class="record-name">${record.name}</div>
                  <div class="record-count">${record.count} wins</div>
                </div>
              </div>
            `).join('') || '<p style="color: var(--gray); font-size: 14px;">No data</p>'}
          </div>
        </div>
      </div>
    `;
    
    contentElements.artistContent.innerHTML = html;
    
    // Load real images for statistics
    setTimeout(() => {
      document.querySelectorAll('.stat-record img').forEach(img => {
        const name = img.alt;
        if (name && name !== '?') {
          getArtistImage(name, 40).then(src => {
            if (src && !src.includes('data:image/svg+xml')) {
              img.src = src;
            }
          });
        }
      });
    }, 100);
  } catch (error) {
    contentElements.artistContent.innerHTML = `
      <div class="error-container">
        <div class="error-icon"><i class="fas fa-exclamation-triangle"></i></div>
        <div class="error-text">Failed to load artist data</div>
        <button class="retry-button" onclick="openArtist('${encodedName}')">
          <i class="fas fa-redo"></i> Retry
        </button>
      </div>
    `;
  }
}

// Load all artists page
async function loadAllArtists() {
  showSection('artistsBrowse');
  contentElements.artistsContent.innerHTML = `
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading artists...</div>
    </div>
  `;
  
  try {
    const artists = await getAllArtistsData();
    
    const html = `
      <div style="margin-bottom: 20px;">
        <p style="color: var(--gray);">Showing ${artists.length} artists with nominations</p>
      </div>
      <div class="artists-grid">
        ${artists.map(artist => `
          <div class="artist-card" onclick="openArtist('${encodeURIComponent(artist.name)}')">
            <img src="${generatePlaceholderImage(artist.name, 200)}" 
                 alt="${artist.name}" 
                 class="artist-card-image"
                 data-artist="${artist.name}">
            <div class="artist-card-info">
              <h3>${artist.name}</h3>
              <div class="artist-card-stats">
                <div class="artist-card-stat">
                  <span>${artist.wins}</span>
                  <span>Wins</span>
                </div>
                <div class="artist-card-stat">
                  <span>${artist.nominations}</span>
                  <span>Nominations</span>
                </div>
              </div>
            </div>
          </div>
        `).join('')}
      </div>
    `;
    
    contentElements.artistsContent.innerHTML = html;
    
    // Load real images
    setTimeout(() => {
      document.querySelectorAll('.artist-card-image[data-artist]').forEach(img => {
        const artist = img.getAttribute('data-artist');
        getArtistImage(artist, 200).then(src => {
          if (src && !src.includes('data:image/svg+xml')) {
            img.src = src;
          }
        });
      });
    }, 100);
  } catch (error) {
    contentElements.artistsContent.innerHTML = `
      <div class="error-container">
        <div class="error-icon"><i class="fas fa-exclamation-triangle"></i></div>
        <div class="error-text">Failed to load artists</div>
        <button class="retry-button" onclick="loadAllArtists()">
          <i class="fas fa-redo"></i> Retry
        </button>
      </div>
    `;
  }
}

// Load statistics page
async function loadStatistics() {
  showSection('stats');
  contentElements.statsContent.innerHTML = `
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading statistics...</div>
    </div>
  `;
  
  try {
    const stats = await getStatistics();
    
    const html = `
      <div class="stats-section">
        <div class="stats-grid">
          <!-- Overall Stats -->
          <div class="stat-record" style="grid-column: span 2;">
            <h3>Overall Statistics</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
              <div style="text-align: center; padding: 15px; background: var(--light-gray); border-radius: 8px;">
                <div style="font-size: 32px; font-weight: 700; color: var(--gold);">${stats.totalArtists}</div>
                <div style="font-size: 14px; color: var(--gray);">Total Artists</div>
              </div>
              <div style="text-align: center; padding: 15px; background: var(--light-gray); border-radius: 8px;">
                <div style="font-size: 32px; font-weight: 700; color: var(--gold);">${stats.totalNominations}</div>
                <div style="font-size: 14px; color: var(--gray);">Total Nominations</div>
              </div>
              <div style="text-align: center; padding: 15px; background: var(--light-gray); border-radius: 8px;">
                <div style="font-size: 32px; font-weight: 700; color: var(--gold);">${stats.totalWins}</div>
                <div style="font-size: 14px; color: var(--gray);">Total Wins</div>
              </div>
              <div style="text-align: center; padding: 15px; background: var(--light-gray); border-radius: 8px;">
                <div style="font-size: 32px; font-weight: 700; color: var(--gold);">${Object.keys(EDITIONS).length}</div>
                <div style="font-size: 14px; color: var(--gray);">Editions</div>
              </div>
            </div>
          </div>
          
          <!-- Most Wins -->
          <div class="stat-record">
            <h3>🏆 Most Wins</h3>
            ${stats.mostWins.slice(0, 8).map((record, i) => `
              <div class="record-item">
                <img src="${generatePlaceholderImage(record.name, 40)}" alt="${record.name}">
                <div class="record-info">
                  <div class="record-name">${record.name}</div>
                  <div class="record-count">${record.count} wins</div>
                </div>
                ${i < 3 ? '<i class="fas fa-trophy" style="color: ' + ['#FFD700', '#C0C0C0', '#CD7F32'][i] + ';"></i>' : ''}
              </div>
            `).join('')}
          </div>
          
          <!-- Most Nominations -->
          <div class="stat-record">
            <h3>⭐ Most Nominations</h3>
            ${stats.mostNominations.slice(0, 8).map((record, i) => `
              <div class="record-item">
                <img src="${generatePlaceholderImage(record.name, 40)}" alt="${record.name}">
                <div class="record-info">
                  <div class="record-name">${record.name}</div>
                  <div class="record-count">${record.count} nominations</div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
        
        <!-- Genre Stats -->
        <h3 style="margin: 40px 0 20px 0; font-size: 24px;">Genre Records</h3>
        <div class="stats-grid">
          ${Object.entries(GENRES).map(([genre, categories]) => {
            const genreStat = stats.genreStats[genre];
            if (!genreStat || genreStat.wins.length === 0) return '';
            
            return `
              <div class="stat-record">
                <h3>${genre.toUpperCase()} Records</h3>
                ${genreStat.wins.slice(0, 5).map(record => `
                  <div class="record-item">
                    <img src="${generatePlaceholderImage(record.name, 40)}" alt="${record.name}">
                    <div class="record-info">
                      <div class="record-name">${record.name}</div>
                      <div class="record-count">${record.count} wins</div>
                    </div>
                  </div>
                `).join('')}
              </div>
            `;
          }).join('')}
        </div>
      </div>
    `;
    
    contentElements.statsContent.innerHTML = html;
    
    // Load real images
    setTimeout(() => {
      document.querySelectorAll('.stat-record img').forEach(img => {
        const name = img.alt;
        if (name && name !== '?') {
          getArtistImage(name, 40).then(src => {
            if (src && !src.includes('data:image/svg+xml')) {
              img.src = src;
            }
          });
        }
      });
    }, 100);
  } catch (error) {
    contentElements.statsContent.innerHTML = `
      <div class="error-container">
        <div class="error-icon"><i class="fas fa-exclamation-triangle"></i></div>
        <div class="error-text">Failed to load statistics</div>
        <button class="retry-button" onclick="loadStatistics()">
          <i class="fas fa-redo"></i> Retry
        </button>
      </div>
    `;
  }
}

// ================= EVENT LISTENERS =================
document.addEventListener('DOMContentLoaded', () => {
  // Initialize
  initializeEditionCards();
  showSection('home');
  
  // Edition cards
  editionsGrid.addEventListener('click', (e) => {
    const card = e.target.closest('.edition-card');
    if (card) {
      const year = card.dataset.year;
      openEdition(year);
    }
  });
  
  // Search
  searchInput.addEventListener('input', debounce((e) => {
    performSearch(e.target.value);
  }, 300));
  
  searchInput.addEventListener('focus', () => {
    if (searchInput.value.length >= 2) {
      searchResults.style.display = 'block';
    }
  });
  
  document.addEventListener('click', (e) => {
    if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
      searchResults.style.display = 'none';
    }
  });
  
  // Navigation
  navElements.homeLink.addEventListener('click', (e) => {
    e.preventDefault();
    showSection('home');
  });
  
  navElements.browseCategories.addEventListener('click', (e) => {
    e.preventDefault();
    loadAllCategories();
  });
  
  navElements.browseArtists.addEventListener('click', (e) => {
    e.preventDefault();
    loadAllArtists();
  });
  
  navElements.statsLink.addEventListener('click', (e) => {
    e.preventDefault();
    loadStatistics();
  });
  
  navElements.aboutLink.addEventListener('click', (e) => {
    e.preventDefault();
    showSection('about');
  });
  
  // Footer navigation
  footerElements.footerHome.addEventListener('click', (e) => {
    e.preventDefault();
    showSection('home');
  });
  
  footerElements.footerCategories.addEventListener('click', (e) => {
    e.preventDefault();
    loadAllCategories();
  });
  
  footerElements.footerArtists.addEventListener('click', (e) => {
    e.preventDefault();
    loadAllArtists();
  });
  
  footerElements.footerStats.addEventListener('click', (e) => {
    e.preventDefault();
    loadStatistics();
  });
  
  footerElements.footerAbout.addEventListener('click', (e) => {
    e.preventDefault();
    showSection('about');
  });
  
  // Back buttons
  backButtons.backButton.addEventListener('click', () => showSection('home'));
  backButtons.backButtonCategories.addEventListener('click', () => showSection('home'));
  backButtons.backButtonArtists.addEventListener('click', () => showSection('home'));
  backButtons.backButtonArtist.addEventListener('click', () => {
    const yearMatch = titleElements.editionTitle.textContent.match(/\d{4}/);
    if (yearMatch) openEdition(yearMatch[0]);
    else showSection('home');
  });
  backButtons.backButtonStats.addEventListener('click', () => showSection('home'));
  backButtons.backButtonAbout.addEventListener('click', () => showSection('home'));
  
  // Pre-load data for faster navigation
  setTimeout(() => {
    fetchSheetData('2023').catch(() => {});
    fetchSheetData('2022').catch(() => {});
  }, 1000);
});

// Helper functions for global access
window.openEdition = openEdition;
window.openArtist = openArtist;
window.openCategory = openCategory;
window.toggleCategory = function(categoryId) {
  const element = document.getElementById(`category-${categoryId.replace(/[^a-zA-Z0-9]/g, '-')}`);
  const toggle = event.currentTarget.querySelector('.category-toggle');
  if (element.style.display === 'none') {
    element.style.display = 'block';
    toggle.textContent = '-';
  } else {
    element.style.display = 'none';
    toggle.textContent = '+';
  }
};

window.loadRealImage = function(imgElement) {
  const artist = imgElement.getAttribute('data-artist');
  if (artist) {
    getArtistImage(artist, parseInt(imgElement.width)).then(src => {
      if (src && !src.includes('data:image/svg+xml')) {
        imgElement.src = src;
      }
    });
  }
};
</script>
</body>
</html>
